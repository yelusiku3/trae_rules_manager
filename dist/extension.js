(()=>{"use strict";var e={265:function(e,n,t){var r,o=this&&this.__createBinding||(Object.create?function(e,n,t,r){void 0===r&&(r=t);var o=Object.getOwnPropertyDescriptor(n,t);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,r,o)}:function(e,n,t,r){void 0===r&&(r=t),e[r]=n[t]}),i=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[n.length]=t);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t=r(e),s=0;s<t.length;s++)"default"!==t[s]&&o(n,e,t[s]);return i(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.activate=function(e){let n=a.commands.registerCommand("trae-rules-manager.showRolePanel",(()=>{l.RolePanel.createOrShow(e.extensionUri)}));e.subscriptions.push(n);let t,r=a.window.activeTextEditor;a.workspace.onDidChangeTextDocument((n=>{r&&n.document===r.document&&(t&&clearTimeout(t),t=setTimeout((()=>{const n=a.window.activeTextEditor;if(n){const t=n.selection.active,r=n.document.lineAt(t.line).text.substring(0,t.character),o=a.workspace.getConfiguration("trae-rules-manager").get("triggerChar","@");r.endsWith(o)&&l.RolePanel.createOrShow(e.extensionUri)}}),a.workspace.getConfiguration("trae-rules-manager").get("debounceDelay",300)))}),null,e.subscriptions),a.window.onDidChangeActiveTextEditor((e=>{r=e}),null,e.subscriptions)},n.deactivate=function(){};const a=s(t(398)),l=t(794)},398:e=>{e.exports=require("vscode")},794:function(e,n,t){var r,o=this&&this.__createBinding||(Object.create?function(e,n,t,r){void 0===r&&(r=t);var o=Object.getOwnPropertyDescriptor(n,t);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,r,o)}:function(e,n,t,r){void 0===r&&(r=t),e[r]=n[t]}),i=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var n=[];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[n.length]=t);return n},r(e)},function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t=r(e),s=0;s<t.length;s++)"default"!==t[s]&&o(n,e,t[s]);return i(n,e),n});Object.defineProperty(n,"__esModule",{value:!0}),n.RolePanel=void 0;const a=s(t(398));class l{constructor(e,n){this._disposables=[],this._panel=e,this._panel.onDidDispose((()=>this.dispose()),null,this._disposables),this._panel.webview.html=this._getWebviewContent(this._panel.webview,n),this._panel.webview.onDidReceiveMessage((e=>{if("selectRole"===e.command){const n=a.window.activeTextEditor;if(n){const t=n.selection.active,r=n.document.lineAt(t.line).text.substring(0,t.character),o=a.workspace.getConfiguration("trae-rules-manager").get("triggerChar","@");r.endsWith(o)&&n.edit((n=>{const r=new a.Position(t.line,t.character-1),o=new a.Position(t.line,t.character);n.delete(new a.Range(r,o)),n.insert(t,e.role.prompt)}))}this._panel.dispose()}}),null,this._disposables)}static createOrShow(e){const n=a.window.activeTextEditor?a.window.activeTextEditor.viewColumn:void 0;if(l.currentPanel)return void l.currentPanel._panel.reveal(n);const t=a.window.createWebviewPanel("traeRoleManager","Trae Role Manager",n||a.ViewColumn.One,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[e]});l.currentPanel=new l(t,e)}_getWebviewContent(e,n){const t=[{id:1,name:"需求分析师",description:"专注于需求分析和文档编写",prompt:"As a requirement analyst, please help me analyze the following requirements:\n"},{id:2,name:"架构师",description:"系统架构设计专家",prompt:"As a system architect, please help me design the architecture for:\n"},{id:3,name:"代码审查员",description:"代码质量和最佳实践",prompt:"As a code reviewer, please review the following code:\n"}];return`\n            <!DOCTYPE html>\n            <html lang="zh-CN">\n            <head>\n                <meta charset="UTF-8">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <title>Trae Role Manager</title>\n                <style>\n                    body {\n                        font-family: var(--vscode-font-family);\n                        padding: 10px;\n                        color: var(--vscode-foreground);\n                        background-color: var(--vscode-editor-background);\n                    }\n                    .search-box {\n                        width: 100%;\n                        padding: 8px;\n                        margin-bottom: 10px;\n                        border: 1px solid var(--vscode-input-border);\n                        background: var(--vscode-input-background);\n                        color: var(--vscode-input-foreground);\n                    }\n                    .role-list {\n                        display: flex;\n                        flex-direction: column;\n                        gap: 8px;\n                    }\n                    .role-item {\n                        padding: 10px;\n                        border: 1px solid var(--vscode-panel-border);\n                        border-radius: 4px;\n                        cursor: pointer;\n                    }\n                    .role-item:hover {\n                        background: var(--vscode-list-hoverBackground);\n                    }\n                    .role-name {\n                        font-weight: bold;\n                        margin-bottom: 4px;\n                    }\n                    .role-description {\n                        font-size: 0.9em;\n                        color: var(--vscode-descriptionForeground);\n                    }\n                </style>\n            </head>\n            <body>\n                <input type="text" class="search-box" placeholder="搜索角色..." id="searchInput">\n                <div class="role-list" id="roleList">\n                    ${t.map((e=>`\n                        <div class="role-item" data-role='${JSON.stringify(e).replace(/'/g,"&apos;")}'>\n                            <div class="role-name">${e.name}</div>\n                            <div class="role-description">${e.description}</div>\n                        </div>\n                    `)).join("")}\n                </div>\n                <script>\n                    const vscode = acquireVsCodeApi();\n                    const searchInput = document.getElementById('searchInput');\n                    const roleList = document.getElementById('roleList');\n                    const roles = ${JSON.stringify(t)};\n    \n                    // 搜索功能\n                    searchInput.addEventListener('input', (e) => {\n                        const searchText = e.target.value.toLowerCase();\n                        const filteredRoles = roles.filter(role =>\n                            role.name.toLowerCase().includes(searchText) ||\n                            role.description.toLowerCase().includes(searchText)\n                        );\n                        \n                        roleList.innerHTML = filteredRoles.map(role => \`\n                            <div class="role-item" data-role='\${JSON.stringify(role).replace(/'/g, "&apos;")}'>\n                                <div class="role-name">\${role.name}</div>\n                                <div class="role-description">\${role.description}</div>\n                            </div>\n                        \`).join('');\n                    });\n    \n                    // 角色选择\n                    roleList.addEventListener('click', (e) => {\n                        const roleItem = e.target.closest('.role-item');\n                        if (roleItem) {\n                            const role = JSON.parse(roleItem.dataset.role.replace(/&apos;/g, "'"));\n                            vscode.postMessage({\n                                command: 'selectRole',\n                                role: role\n                            });\n                        }\n                    });\n                <\/script>\n            </body>\n            </html>\n        `}dispose(){for(l.currentPanel=void 0,this._panel.dispose();this._disposables.length;){const e=this._disposables.pop();e&&e.dispose()}}}n.RolePanel=l}},n={},t=function t(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={exports:{}};return e[r].call(i.exports,i,i.exports,t),i.exports}(265);module.exports=t})();